{"version":3,"sources":["webpack:///./node_modules/matrix-react-sdk/src/async-components/views/dialogs/security/ExportE2eKeysDialog.js","webpack:///./node_modules/matrix-react-sdk/src/utils/MegolmExportEncryption.ts"],"names":["ExportE2eKeysDialog","React","Component","constructor","props","super","ev","preventDefault","passphrase","this","_passphrase1","current","value","_passphrase2","setState","errStr","_t","_startExport","onFinished","_unmounted","createRef","state","phase","componentWillUnmount","Promise","resolve","then","matrixClient","exportRoomKeys","k","MegolmExportEncryption","JSON","stringify","f","blob","Blob","type","FileSaver","saveAs","catch","e","logger","error","msg","friendlyText","render","BaseDialog","sdk","disableForm","className","title","onSubmit","_onPassphraseFormSubmit","htmlFor","ref","id","autoFocus","size","disabled","onClick","_onCancelClick","PropTypes","instanceOf","MatrixClient","isRequired","func","subtleCrypto","window","crypto","subtle","webkitSubtle","friendlyError","message","cryptoFailMsg","async","decryptMegolmKeyFile","data","password","body","fileStr","TextDecoder","decode","Uint8Array","lineStart","lineEnd","indexOf","Error","line","slice","trim","HEADER_LINE","dataStart","undefined","dataEnd","base64","latin1String","atob","uint8Array","length","i","charCodeAt","decodeBase64","unpackMegolmKeyFile","brand","SdkConfig","get","ciphertextLength","salt","subarray","iv","iterations","ciphertext","hmac","aesKey","hmacKey","deriveKeys","toVerify","isValid","plaintext","verify","name","decrypt","counter","encryptMegolmKeyFile","options","kdfRounds","kdf_rounds","getRandomValues","encodedData","TextEncoder","encode","encrypt","cipherArray","bodyLength","resultBuffer","idx","set","toSign","sign","hmacArray","nLines","Math","ceil","lines","Array","o","encodeBase64","join","buffer","packMegolmKeyFile","start","Date","key","keybits","importKey","deriveBits","hash","now","log","getTime","aesProm","hmacProm","all","String","fromCharCode","apply","btoa"],"mappings":"4PA8Be,MAAMA,UAA4BC,IAAMC,UAMnDC,YAAYC,GACRC,MAAMD,GADS,mCAkBQE,IACvBA,EAAGC,iBAEH,MAAMC,EAAaC,KAAKC,aAAaC,QAAQC,MAC7C,OAAIJ,IAAeC,KAAKI,aAAaF,QAAQC,OACzCH,KAAKK,SAAS,CAAEC,OAAQC,YAAG,6BACpB,GAENR,GAKLC,KAAKQ,aAAaT,IACX,IALHC,KAAKK,SAAS,CAAEC,OAAQC,YAAG,mCACpB,KA5BI,0BAoEDV,IACdA,EAAGC,iBACHE,KAAKL,MAAMc,YAAW,IACf,IApEPT,KAAKU,YAAa,EAElBV,KAAKC,aAAeU,sBACpBX,KAAKI,aAAeO,sBAEpBX,KAAKY,MAAQ,CACTC,MAlBO,EAmBPP,OAAQ,MAIhBQ,uBACId,KAAKU,YAAa,EAoBtBF,aAAaT,GAGTgB,QAAQC,UAAUC,KAAK,IACZjB,KAAKL,MAAMuB,aAAaC,kBAChCF,KAAMG,GACEC,IACHC,KAAKC,UAAUH,GAAIrB,IAExBkB,KAAMO,IACL,MAAMC,EAAO,IAAIC,KAAK,CAACF,GAAI,CACvBG,KAAM,gCAEVC,IAAUC,OAAOJ,EAAM,oBACvBzB,KAAKL,MAAMc,YAAW,KACvBqB,MAAOC,IAEN,GADAC,IAAOC,MAAM,4BAA6BF,GACtC/B,KAAKU,WACL,OAEJ,MAAMwB,EAAMH,EAAEI,cAAgB5B,YAAG,iBACjCP,KAAKK,SAAS,CACVC,OAAQ4B,EACRrB,MAnEG,MAuEXb,KAAKK,SAAS,CACVC,OAAQ,KACRO,MAxEY,IAkFpBuB,SACI,MAAMC,EAAaC,eAAiB,4BAE9BC,EArFU,IAqFKvC,KAAKY,MAAMC,MAEhC,OACI,kBAACwB,EAAD,CAAYG,UAAU,yBAClB/B,WAAYT,KAAKL,MAAMc,WACvBgC,MAAOlC,YAAG,qBAEV,0BAAMmC,SAAU1C,KAAK2C,yBACjB,yBAAKH,UAAU,qBACX,2BACMjC,YACE,iQAOR,2BACMA,YACE,2UAQR,yBAAKiC,UAAU,SACTxC,KAAKY,MAAMN,QAEjB,yBAAKkC,UAAU,+BACX,yBAAKA,UAAU,6BACX,yBAAKA,UAAU,+BACX,2BAAOI,QAAQ,eACTrC,YAAG,sBAGb,yBAAKiC,UAAU,8BACX,2BACIK,IAAK7C,KAAKC,aACV6C,GAAG,cACHC,WAAW,EACXC,KAAK,KACLrB,KAAK,WACLsB,SAAUV,MAItB,yBAAKC,UAAU,6BACX,yBAAKA,UAAU,+BACX,2BAAOI,QAAQ,eACTrC,YAAG,wBAGb,yBAAKiC,UAAU,8BACX,2BAAOK,IAAK7C,KAAKI,aACb0C,GAAG,cACHE,KAAK,KACLrB,KAAK,WACLsB,SAAUV,QAM9B,yBAAKC,UAAU,qBACX,2BACIA,UAAU,oBACVb,KAAK,SACLxB,MAAOI,YAAG,UACV0C,SAAUV,IAEd,4BAAQW,QAASlD,KAAKmD,eAAgBF,SAAUV,GAC1ChC,YAAG,e,IA7JZhB,E,YACE,CACf2B,aAAckC,IAAUC,WAAWC,KAAcC,WACjD9C,WAAY2C,IAAUI,KAAKD,c,iCCjCnC,+FAsBA,MAAME,EAAeC,OAAOC,OAAOC,QAAUF,OAAOC,OAAOE,aAU3D,SAASC,EACLC,EAAiB5B,GAEjB,MAAO,CAAE4B,UAAS5B,gBAGtB,SAAS6B,IACL,OAAOzD,YAAG,sEAYP0D,eAAeC,EAAqBC,EAAmBC,GAC1D,MAAMC,EAiOV,SAA6BF,GAIzB,MAAMG,GAAU,IAAIC,aAAcC,OAAO,IAAIC,WAAWN,IAGxD,IAAIO,EAAY,EAEhB,OAAU,CACN,MAAMC,EAAUL,EAAQM,QAAQ,KAAMF,GACtC,GAAIC,EAAU,EACV,MAAM,IAAIE,MAAM,yBAEpB,MAAMC,EAAOR,EAAQS,MAAML,EAAWC,GAASK,OAK/C,GAFAN,EAAYC,EAAQ,EAEhBG,IAASG,EACT,MAIR,MAAMC,EAAYR,EAIlB,OAAU,CACN,MAAMC,EAAUL,EAAQM,QAAQ,KAAMF,GAEtC,GAzCa,sCAwCAJ,EAAQS,MAAML,EAAWC,EAAU,OAAIQ,EAAYR,GAASK,OAErE,MAGJ,GAAIL,EAAU,EACV,MAAM,IAAIE,MAAM,0BAIpBH,EAAYC,EAAQ,EAGxB,MAAMS,EAAUV,EAChB,OA+CJ,SAAsBW,GAElB,MAAMC,EAAe5B,OAAO6B,KAAKF,GAE3BG,EAAa,IAAIf,WAAWa,EAAaG,QAC/C,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAaG,OAAQC,IACrCF,EAAWE,GAAKJ,EAAaK,WAAWD,GAE5C,OAAOF,EAvDAI,CAAatB,EAAQS,MAAMG,EAAWE,IA7QhCS,CAAoB1B,GAC3B2B,EAAQC,IAAUC,MAAMF,MAG9B,GAAIzB,EAAKoB,OAAS,EACd,MAAM3B,EAAc,0BAChBvD,YAAG,gCAAiC,CAAEuF,WAI9C,GAAgB,IADAzB,EAAK,GAEjB,MAAMP,EAAc,sBAChBvD,YAAG,gCAAiC,CAAEuF,WAG9C,MAAMG,EAAmB5B,EAAKoB,OAAL,GACzB,GAAIQ,EAAmB,EACnB,MAAMnC,EAAc,0BAChBvD,YAAG,gCAAiC,CAAEuF,WAG9C,MAAMI,EAAO7B,EAAK8B,SAAS,EAAG,IACxBC,EAAK/B,EAAK8B,SAAS,GAAI,IACvBE,EAAahC,EAAK,KAAO,GAAKA,EAAK,KAAO,GAAKA,EAAK,KAAO,EAAIA,EAAK,IACpEiC,EAAajC,EAAK8B,SAAS,GAAI,GAAGF,GAClCM,EAAOlC,EAAK8B,UAAU,KAErBK,EAAQC,SAAiBC,EAAWR,EAAMG,EAAYjC,GACvDuC,EAAWtC,EAAK8B,SAAS,GAAI,IAEnC,IAAIS,EAgBAC,EAfJ,IACID,QAAgBnD,EAAaqD,OACzB,CAAEC,KAAM,QACRN,EACAF,EACAI,GAEN,MAAO5E,GACL,MAAM+B,EAAc,+BAAiC/B,EAAGiC,KAE5D,IAAK4C,EACD,MAAM9C,EAAc,gBAChBvD,YAAG,qDAIX,IACIsG,QAAkBpD,EAAauD,QAC3B,CACID,KAAM,UACNE,QAASb,EACTX,OAAQ,IAEZe,EACAF,GAEN,MAAOvE,GACL,MAAM+B,EAAc,gCAAkC/B,EAAGiC,KAG7D,OAAO,IAAIO,aAAcC,OAAO,IAAIC,WAAWoC,IAa5C5C,eAAeiD,EAClB/C,EACAC,EACA+C,GAGA,MAAMC,GADND,EAAUA,GAAW,IACKE,YAAc,IAElCnB,EAAO,IAAIzB,WAAW,IAC5Bf,OAAOC,OAAO2D,gBAAgBpB,GAE9B,MAAME,EAAK,IAAI3B,WAAW,IAC1Bf,OAAOC,OAAO2D,gBAAgBlB,GAK9BA,EAAG,IAAM,IAET,MAAOI,EAAQC,SAAiBC,EAAWR,EAAMkB,EAAWhD,GACtDmD,GAAc,IAAIC,aAAcC,OAAOtD,GAE7C,IAAImC,EACJ,IACIA,QAAmB7C,EAAaiE,QAC5B,CACIX,KAAM,UACNE,QAASb,EACTX,OAAQ,IAEZe,EACAe,GAEN,MAAOxF,GACL,MAAM+B,EAAc,gCAAkC/B,EAAGiC,KAG7D,MAAM2D,EAAc,IAAIlD,WAAW6B,GAC7BsB,EAAc,EAAE1B,EAAKT,OAAOW,EAAGX,OAAO,EAAEkC,EAAYlC,OAAO,GAC3DoC,EAAe,IAAIpD,WAAWmD,GACpC,IAAIE,EAAM,EACVD,EAAaC,KAAS,EACtBD,EAAaE,IAAI7B,EAAM4B,GAAMA,GAAO5B,EAAKT,OACzCoC,EAAaE,IAAI3B,EAAI0B,GAAMA,GAAO1B,EAAGX,OACrCoC,EAAaC,KAASV,GAAa,GACnCS,EAAaC,KAAUV,GAAa,GAAM,IAC1CS,EAAaC,KAAUV,GAAa,EAAK,IACzCS,EAAaC,KAAqB,IAAZV,EACtBS,EAAaE,IAAIJ,EAAaG,GAAMA,GAAOH,EAAYlC,OAEvD,MAAMuC,EAASH,EAAa1B,SAAS,EAAG2B,GAExC,IAAIvB,EACJ,IACIA,QAAa9C,EAAawE,KACtB,CAAElB,KAAM,QACRN,EACAuB,GAEN,MAAOjG,GACL,MAAM+B,EAAc,6BAA+B/B,EAAGiC,KAG1D,MAAMkE,EAAY,IAAIzD,WAAW8B,GAEjC,OADAsB,EAAaE,IAAIG,EAAWJ,GA8IhC,SAA2B3D,GAGvB,MACMgE,EAASC,KAAKC,KAAKlE,EAAKsB,OADT,IAEf6C,EAAQ,IAAIC,MAAMJ,EAAS,GACjCG,EAAM,GAAKrD,EACX,IACIS,EADA8C,EAAI,EAER,IAAK9C,EAAI,EAAGA,GAAKyC,EAAQzC,IACrB4C,EAAM5C,GAAK+C,EAAatE,EAAKgC,SAASqC,EAAGA,EAPxB,KAQjBA,GARiB,GAYrB,OAFAF,EAAM5C,KA9EW,oCA+EjB4C,EAAM5C,GAAK,IACH,IAAI8B,aAAcC,OAAOa,EAAMI,KAAK,OAAQC,OA5J7CC,CAAkBf,GAW7B5D,eAAeyC,EAAWR,EAAkBG,EAAoBjC,GAC5D,MAAMyE,EAAQ,IAAIC,KAElB,IAAIC,EAaAC,EAZJ,IACID,QAAYtF,EAAawF,UACrB,OACA,IAAIzB,aAAcC,OAAOrD,GACzB,CAAE2C,KAAM,WACR,EACA,CAAC,eAEP,MAAOhF,GACL,MAAM+B,EAAc,kCAAoC/B,EAAGiC,KAI/D,IACIgF,QAAgBvF,EAAayF,WACzB,CACInC,KAAM,SACNb,KAAMA,EACNG,WAAYA,EACZ8C,KAAM,WAEVJ,EACA,KAEN,MAAOhH,GACL,MAAM+B,EAAc,mCAAqC/B,EAAGiC,KAGhE,MAAMoF,EAAM,IAAIN,KAChB9G,IAAOqH,IAAI,uCAAyCD,EAAIE,UAAYT,EAAMS,WAAa,MAEvF,MAAM9C,EAASwC,EAAQjE,MAAM,EAAG,IAC1B0B,EAAUuC,EAAQjE,MAAM,IAExBwE,EAAU9F,EAAawF,UACzB,MACAzC,EACA,CAAEO,KAAM,YACR,EACA,CAAC,UAAW,YACdjF,MAAOC,IACL,MAAM+B,EAAc,8CAAgD/B,EAAGiC,OAGrEwF,EAAW/F,EAAawF,UAC1B,MACAxC,EACA,CACIM,KAAM,OACNoC,KAAM,CAAEpC,KAAM,aAElB,EACA,CAAC,OAAQ,WACXjF,MAAOC,IACL,MAAM+B,EAAc,+CAAiD/B,EAAGiC,OAG5E,aAAajD,QAAQ0I,IAAI,CAACF,EAASC,IAGvC,MAAMvE,EAAc,sCAyFpB,SAASwD,EAAajD,GAGlB,MAAMF,EAAeoE,OAAOC,aAAaC,MAAM,KAAMpE,GAErD,OAAO9B,OAAOmG,KAAKvE","file":"bundles/e8d1e9646ad7cdbac0b6/4.js","sourceRoot":""}